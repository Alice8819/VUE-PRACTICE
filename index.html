<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./index.css">
</head>

<body>
    <div id="app">
        <ul>
            <li v-for="item,itemIndex of goodsList" :key="item.id" class="goods">
                {{item.title}}
                <ul class="type-list">
                    <li v-for="each,eachIndex in item.typeList" :key="each" class="type"
                        :class="{active:eachIndex==item.index}" @click="addToList(each,eachIndex,item,itemIndex)">
                        {{each}}</li>
                </ul>
            </li>
        </ul>

        <div class="selected choose-type">
            已选条件：
            <span v-if="showFlag" class="no-goods">暂时没有选择过滤条件</span>
            <ul v-else class="filter-list">
                <li v-for="item,key in selected">{{item}}
                    <span @click="deleteSelected(key)">x</span>
                </li>

            </ul>
        </div>


    </div>

    <script src="vue.js"></script>
    <script>
        const vm = new Vue({
            el: "#app",
            data: {
                goodsList: [
                    {
                        title: '上装:',
                        typeList: ['全部', '针织衫', '毛呢外套', 'T恤', '羽绒服', '棉衣', '卫衣', '风衣'],
                        id: 1,
                    },
                    {
                        title: '裤装:',
                        typeList: ['全部', '牛仔裤', '小脚/铅笔裤', '休闲裤', '打底裤', '哈伦裤'],
                        id: 2,
                    },
                    {
                        title: '裙装:',
                        typeList: ['全部', '连衣裙', '半身裙', '长袖连衣裙', '中长款连衣裙'],
                        id: 3,
                    }
                ],

                selected: {},
                showFlag: true,
            },
            methods: {
                addToList(each, eachIndex, item, itemIndex) {
                    // 添加
                    if(each === "全部"){
                        this.goodsList[itemIndex].index = 0;
                        this.deleteSelected(itemIndex);
                        return;
                    }
                    this.$set(this.selected, itemIndex, each);
                    this.showFlag = false;

                    // active 显示
                    this.goodsList[itemIndex].index = eachIndex;

                },


                deleteSelected(key) {
                    // 删除
                    this.$delete(this.selected, key);
                    this.handleShowFlag();   // 当为{}时，显示文字

                    // active 显示
                    this.goodsList[key].index = 0;
                },

                handleShowFlag() {
                    if(JSON.stringify(this.selected) === "{}"){
                        this.showFlag = true;
                    }
                }
            }
        })

        vm.goodsList.map((item, index) => {
            vm.$set(item, "index", 0);
        })

    </script>


</body>

</html>